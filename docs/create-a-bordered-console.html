<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>Create a bordered console | Thraka&#39;s Home</title>
  <meta name="author" content="Thraka">
  
  <meta name="description" content="A lot of the time you want a border around a console, which is pretty easy to do using the Box shape. However, if you want to use typing/virtual curso">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Create a bordered console"/>
  <meta property="og:site_name" content="Thraka&#39;s Home"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-76753055-1', 'auto');
  ga('send', 'pageview');
</script>




</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">Thraka&#39;s Home</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
            
            <a href="/blog" title="All the articles">
            
			  <i class=""></i>Blog
			</a>
		  </li>
		  
		  <li>
            
            <a href="/docs" title="Documentation for SadConsole">
            
			  <i class=""></i>Documentation
			</a>
		  </li>
		  
		  <li>
            
			<a href="https://github.com/thraka/sadconsole" title="SadConsole GitHub">
            
			  <i class="fa fa-github"></i>Github
			</a>
		  </li>
		  
		  <li>
            
			<a href="https://www.reddit.com/r/sadconsole/" title="SadConsole SubReddit">
            
			  <i class="fa fa-reddit"></i>Reddit
			</a>
		  </li>
		  
		  <li>
            
            <a href="/atom.xml" title="Subscribe">
            
			  <i class="fa fa-rss"></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 
	
		<div class="page-header">
			<h1> Create a bordered console</h1>
		</div>
	



<div class="row page">
	<!-- cols -->
	
	<div class="col-md-12">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p>A lot of the time you want a border around a console, which is pretty easy to do using the <code>Box</code> shape. However, if you want to use typing/virtual cursor or you’re printing things that may wrap the next line, this becomes a problem. The text will wrap into the box border:</p>
<p><img src="images/text-wrap-border-problem.png" alt="bordered console"></p>
<p>A border is supposed to be a decoration for the console and not get in the way of the console’s normal functions. We can solve this by separating out the border from the console and treating it as its own object.</p>
<h2 id="use-a-second-surface"><a class="markdownIt-Anchor" href="#use-a-second-surface"></a> Use a second surface</h2>
<p>We can solve the border problem is by rendering a second <code>BasicSurface</code> whenever our console draws. A normal console is a combination of two things, a <code>BasicSurface</code> and a <code>SurfaceRenderer</code>. All we need to do is hook into the draw process and tell the system to draw a border positioned at <strong>-1,-1</strong> relative to the console’s position. The border will be <strong>+2,+2</strong> in size compared to the console.</p>
<p>Let’s create the extra <code>BasicSurface</code> in our new <code>BorderedConsole</code> class.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> SadConsole.Consoles;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">RoguelikeGame</span></span><br><span class="line">&#123;</span><br><span class="line">    class BorderedConsole : SadConsole.Console</span><br><span class="line">    &#123;</span><br><span class="line">        SadConsole.Surfaces.BasicSurface borderSurface;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">BorderedConsole</span>(<span class="params"><span class="keyword">int</span> width, <span class="keyword">int</span> height</span>) : <span class="title">base</span>(<span class="params">width, height</span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Print(<span class="number">0</span>, <span class="number">0</span>, <span class="string">"This is a bunch of text data where we can see that there is a border around it"</span>);</span><br><span class="line"></span><br><span class="line">            borderSurface = <span class="keyword">new</span> SadConsole.Surfaces.BasicSurface(width + <span class="number">2</span>, height + <span class="number">2</span>, <span class="keyword">base</span>.textSurface.Font);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Now that the <code>BasicSurface</code> that will hold our border is created, lets draw a box. To draw on a <code>BasicSurface</code> we use the <code>SurfaceEditor</code>. Add the following code below the creation of the <strong>borderSurface</strong>.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> editor = <span class="keyword">new</span> SadConsole.Surfaces.SurfaceEditor(borderSurface);</span><br></pre></td></tr></table></figure>
<p>This line creates creates a <code>SurfaceEditor</code> instance which we can use to change the surface. SadConsole provides a shape class for making boxes: <code>SadConsole.Shapes.Box</code>. Let’s create that, and use the editor instance to draw on the surface.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create a box style using the thick looking lines</span></span><br><span class="line">SadConsole.Shapes.Box box = SadConsole.Shapes.Box.Thick();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set the box width/height to match the border</span></span><br><span class="line">box.Width = borderSurface.Width;</span><br><span class="line">box.Height = borderSurface.Height;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Draw the box using the editor object to the surface</span></span><br><span class="line"><span class="comment">// this alters the appropriate cells of the surface to have the look of the box</span></span><br><span class="line">box.Draw(editor);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Use a renderer to draw all the surface cells to a cached graphics texture</span></span><br><span class="line"><span class="keyword">base</span>.Renderer.Render(borderSurface);</span><br></pre></td></tr></table></figure>
<p>You notice that <code>base.Renderer.Render</code> line? This actually draws the surface, not the screen though, but to memory. Each <strong>Surface</strong> has a <code>LastRenderResult</code> property that represents the last drawn state, which is a cached texture. When a <strong>Renderer</strong> goes to draw a surface, it checks for a <code>Surface.IsDirty</code> flag. If that flag is <code>true</code>, then the <code>LastRenderResult</code> is redrawn with the latest state of the console. This way, even if you call <code>Render</code> multiple times, though the surface has not actually changed, CPU/GPU time is not wasted.</p>
<p>How do we get our border to the screen though? Our console will automatically be drawn to the screen, so we’ll hook into that process and draw the border along with the console. Override the <code>Draw</code> method and add code that will draw the border surface to the screen <em>before</em> the main console is drawn.</p>
<p>In the <code>Draw</code> method we use a <strong>DrawCall</strong> to get something to the screen, part of the SadConsole’s core drawing system. SadConsole gathers all drawing calls each frame and then renders them (eventually) to the screen. We need to tell SadConsole we want to draw our cached surface to the screen.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Draw</span>(<span class="params">TimeSpan delta</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// Draw our border to the screen</span></span><br><span class="line">    Global.DrawCalls.Add(<span class="keyword">new</span> DrawCallSurface(borderSurface, <span class="keyword">this</span>.calculatedPosition - <span class="keyword">new</span> Point(<span class="number">1</span>), UsePixelPositioning));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Draw the main console to the screen</span></span><br><span class="line">    <span class="keyword">base</span>.Draw(delta);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Now when we move and draw the console, it will look similar like this:</p>
<p><img src="images/text-wrap-border-solution1.png" alt="bordered console"></p>
<h2 id="final-code"><a class="markdownIt-Anchor" href="#final-code"></a> Final code</h2>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> SadConsole.Consoles;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">RoguelikeGame</span></span><br><span class="line">&#123;</span><br><span class="line">    class BorderedConsole : SadConsole.Console</span><br><span class="line">    &#123;</span><br><span class="line">        SadConsole.Surfaces.BasicSurface borderSurface;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">BorderedConsole</span>(<span class="params"><span class="keyword">int</span> width, <span class="keyword">int</span> height</span>) : <span class="title">base</span>(<span class="params">width, height</span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Print(<span class="number">0</span>, <span class="number">0</span>, <span class="string">"This is a bunch of text data where we can see that there is a border around it"</span>);</span><br><span class="line"></span><br><span class="line">            borderSurface = <span class="keyword">new</span> SadConsole.Surfaces.BasicSurface(width + <span class="number">2</span>, height + <span class="number">2</span>, <span class="keyword">base</span>.textSurface.Font);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> editor = <span class="keyword">new</span> SadConsole.Surfaces.SurfaceEditor(borderSurface);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Create a box style using the thick looking lines</span></span><br><span class="line">            SadConsole.Shapes.Box box = SadConsole.Shapes.Box.Thick();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Set the box width/height to match the border</span></span><br><span class="line">            box.Width = borderSurface.Width;</span><br><span class="line">            box.Height = borderSurface.Height;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Draw the box using the editor object to the surface</span></span><br><span class="line">            <span class="comment">// this alters the appropriate cells of the surface to have the look of the box</span></span><br><span class="line">            box.Draw(editor);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Use a renderer to draw all the surface cells to a cached graphics texture</span></span><br><span class="line">            <span class="keyword">base</span>.Renderer.Render(borderSurface);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Draw</span>(<span class="params">TimeSpan delta</span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">// Draw our border to the screen</span></span><br><span class="line">            Global.DrawCalls.Add(<span class="keyword">new</span> DrawCallSurface(borderSurface, <span class="keyword">this</span>.calculatedPosition - <span class="keyword">new</span> Point(<span class="number">1</span>), UsePixelPositioning));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Draw the main console to the screen</span></span><br><span class="line">            <span class="keyword">base</span>.Draw(delta);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">

    
</div>

    </center>
	</div>
	
	<!-- comment -->
	

	</div> <!-- col-md-9/col-md-12 -->
		
		

</div><!-- row -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2018 Thraka
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a>,<a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>,<a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a> and <a href="http://getbootstrap.com/" target="_blank">BOOTSTRA.386</a>. 
     <br> Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind.386</a>.    
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



</body>
   </html>
